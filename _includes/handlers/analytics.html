<!-- Enables Universal Analytics from Google if a domain and ID were added to "config.yml" -->
{% if site.google.id != "UA-XXXXXXXX-X" %}
  {% if site.google.domain != "XXXXXX.github.io" %}

  <script>
    (function (i, s, o, g, r, a, m) {
        i["GoogleAnalyticsObject"] = r;
        i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o), m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m);
    })(window, document, "script", "//www.google-analytics.com/analytics.js", "ga");

    ga("create", "{{site.google.id}}", "{{site.google.domain}}");
    ga("send", "pageview");

    // Tracks page scroll events for Universal Analytics
    $(function () {
        var isDuplicateScrollEvent,
        scrollTimeStart = new Date(),
            $window = $(window),
            $document = $(document),
            scrollPercent;

        $window.scroll(function () {
            scrollPercent = Math.round(100 * ($window.height() + $window.scrollTop()) / $document.height());
            if (scrollPercent > 90 && !isDuplicateScrollEvent) { // page scrolled to 90%
                isDuplicateScrollEvent = 1;
                ga('send', 'event', 'scroll',
                    'Window: ' + $window.height() + 'px; Document: ' + $document.height() + 'px; Time: ' + Math.round((new Date() - scrollTimeStart) / 1000, 1) + 's');
            }
        });
    });
  </script>

  {% endif %}
{% endif %}
